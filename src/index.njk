---
title: d2r
layout: "base.njk"
---

<head>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>

<div class="flex h-full justify-center items-center md:mt-16">
    <div class="flex flex-wrap">
        <div class="text-4xl mx-auto">
            What boss drops
        </div>
        <div class="text-2xl md:text-4xl mx-auto flex-grow mx-8 my-4 md:my-0 inline-flex">
            {# <input class="text-center w-full" type="text" id="itemname" name="itemname" value="shako" autofocus> #}

            <form autocomplete="off">
                <input type="text" class="text-center w-full h-12" name="q" id="search" onKeyUp="showSearchResults(this.value)" />
                <div class="flex text-xl justify-center fixed bg-gray-50" id="searchresult"></div>
            </form>
        </div>
    </div>
</div>

<div class="border mt-12 flex text-xl justify-center">
    <ul>
        <li class="result">Mephisto [Hell]</li>
    </ul>
</div>


<script type="text/javascript">
    $.getJSON('results.json', function(data) {
        console.log('results.json loaded');
        unique_items = get_unique_items_list(data);
    });

    function searchresult_onclick(data) {
        let search_input = document.getElementById("search");
        search_input.value = data;

        const searchresult = document.querySelector('#searchresult');
        removeAllChildNodes(searchresult);
    };

    function get_unique_items_list(data) {
        let items = data['uniqueitems'].map(x => x['index']);

        console.log("unique items loaded");
        console.log(items);
        return items;
    }

    function autocompleteMatch(input) {
        if (input == '') {
            return [];
        }
        var reg = new RegExp(input, "i")
        return unique_items.filter(function(term) {
            if (term.match(reg)) {
            return term;
            }
        });
    }

    function showSearchResults(val) {
        res = document.getElementById("searchresult");
        res.innerHTML = '';
        let list = '';
        let terms = autocompleteMatch(val);
        for (i=0; i < terms.length; i++) {
            list += '<li onclick="searchresult_onclick(this.innerHTML)">' + terms[i] + '</li>';
        }
        res.innerHTML = '<ul>' + list + '</ul>';
    }

    function removeAllChildNodes(parent) {
        while (parent.firstChild) {
            parent.removeChild(parent.firstChild);
        }
    }
</script>